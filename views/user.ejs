<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans&display=swap" rel="stylesheet">
    <style>
        .navbar{
            padding: 0;
            background-color: #262626;
        }
        .navbar .nav-link:hover{
            border-bottom:1px solid white;
            transition:border 0.2s;
        }
        .navbar-nav a{
            font-size:16px;
            font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
        }
        .navbar-brand{
            font-size: 45px;
        }
        .breadcumb-image{
            background-image: url('https://images.unsplash.com/photo-1605296867304-46d5465a13f1?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80');
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            background-attachment: fixed;
            height: 300px;
        }
        .breadcumb-image{
            display: flex;
            flex-direction:column;
            justify-content: center;
            align-items: center;
            color: #fff;
        }
        .bg-overley{
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        .nav li a {
            color: #8a8a8a;
            width: auto;
            display: block;
            text-decoration: none;
            background-color: transparent;
            font-size: 12px;
            font-weight: 700;
        }
        .navbar.scrolled{
            background-color: #2b3636;
            transition:background-color 500ms;
        }
    </style>
    <title>User Profile</title>
  </head>
  <body>

    <%- include('partials/navbar') %> 

    

    <!--User Profile data address  mobile-->
    <div class="container" style="margin-top:200px">
      <div class="row h-100 align-items-center">
          <div class="col-md-6 ml-3">
             <h3>Profile settings</h3>
             <p>
               Change your profile settings here
             </p>
          </div>
          <div class="col-md-5">
              <img src="imgs/profile.svg" width="300" alt="" class="img-fluid">
          </div>
        </div>
    </div>

    <div class="container">
      <% if(error && error.length > 0){ %>
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
              <%= error %>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
          </div>
      <% } %>
      <% if(success && success.length > 0){ %>
          <div class="alert alert-success alert-dismissible fade show" role="alert">
              <%= success %>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
          </div>
      <% } %>
   </div>

 
    <div class="container mt-5">
        <div class="row">
            <div class="col-12">
                <form action="/updateUser/<%= user._id %> " method="POST">
                    <div class="form-row">
                      <div class="form-group col-md-4">
                        <label for="email">Email</label>
                        <input type="email" value="<%= user.email %>" name="email" class="form-control" id="email">
                      </div>
                      <div class="form-group col-md-4">
                        <label for="username">UserName</label>
                        <input type="text" value="<%= user['username'] %>"  name="username" class="form-control" id="username">
                      </div>
                      <div class="form-group col-md-4">
                        <label for="mobileno">Mobile Number</label>
                        <input type="tel" value="<%= user['mobile'] %>"  plcaeholder="Enter Mobile Number"  name="mobile" class="form-control" id="mobileno">
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="inputAddress">Address</label>
                      <input type="text" class="form-control" value="<%= user['address1'] %>"  name="address1" id="inputAddress" placeholder="1234 Main St">
                    </div>
                    <div class="form-group">
                      <label for="inputAddress2">Address 2</label>
                      <input type="text" class="form-control" value="<%= user['address2'] %>"  name="address2" id="inputAddress2" placeholder="Apartment, studio, or floor">
                    </div>
                    <div class="form-row">
                      <div class="form-group col-md-6">
                        <label for="inputCity">City</label>
                        <input type="text" class="form-control" value="<%= user['city'] %>"  name="city" id="inputCity">
                      </div>
                      <div class="form-group col-md-4">
                        <label for="inputState">State</label>
                        <select name="state" id="state"  class="form-control">
                          <% if (user['state']) { %>
                          <option value="<%= user['state'] %>" selected><%= user['state'] %> </option>
                          <% } %>
                          <option value="Andhra Pradesh">Andhra Pradesh</option>
                          <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                          <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                          <option value="Assam">Assam</option>
                          <option value="Bihar">Bihar</option>
                          <option value="Chandigarh">Chandigarh</option>
                          <option value="Chhattisgarh">Chhattisgarh</option>
                          <option value="Dadar and Nagar Haveli">Dadar and Nagar Haveli</option>
                          <option value="Daman and Diu">Daman and Diu</option>
                          <option value="Delhi">Delhi</option>
                          <option value="Lakshadweep">Lakshadweep</option>
                          <option value="Puducherry">Puducherry</option>
                          <option value="Goa">Goa</option>
                          <option value="Gujarat">Gujarat</option>
                          <option value="Haryana">Haryana</option>
                          <option value="Himachal Pradesh">Himachal Pradesh</option>
                          <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                          <option value="Jharkhand">Jharkhand</option>
                          <option value="Karnataka">Karnataka</option>
                          <option value="Kerala">Kerala</option>
                          <option value="Madhya Pradesh">Madhya Pradesh</option>
                          <option value="Maharashtra">Maharashtra</option>
                          <option value="Manipur">Manipur</option>
                          <option value="Meghalaya">Meghalaya</option>
                          <option value="Mizoram">Mizoram</option>
                          <option value="Nagaland">Nagaland</option>
                          <option value="Odisha">Odisha</option>
                          <option value="Punjab">Punjab</option>
                          <option value="Rajasthan">Rajasthan</option>
                          <option value="Sikkim">Sikkim</option>
                          <option value="Tamil Nadu">Tamil Nadu</option>
                          <option value="Telangana">Telangana</option>
                          <option value="Tripura">Tripura</option>
                          <option value="Uttar Pradesh">Uttar Pradesh</option>
                          <option value="Uttarakhand">Uttarakhand</option>
                          <option value="West Bengal">West Bengal</option>
                          </select>
                      </div>
                      <div class="form-group col-md-2">
                        <label for="inputZip">Zip</label>
                        <input type="text" value=<%= user['zip'] %>  name="zip" class="form-control" id="inputZip">
                      </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Update User Profile</button>
                </form>
            </div>
        </div>
    </div>
    <!--User profile ends here-->

    <div class="container mt-5">
      <div class="row h-100 align-items-center">
          <div class="col-md-6 ml-3">
            <img src="imgs/products.svg" width="300" alt="" class="img-fluid">
          </div>
          <div class="col-md-5 ">
             <h3>Your Purchases</h3>
             <p>
               All the purchases that you have done till now.
             </p>
          </div>
          
        </div>
    </div>

    <!--Purchases Table-->
    <div class="container mt-5">
        <div class="row">
          <% if (user['purchases'].length>0) { %>
            <div class="col-12">
              <table class="table">
                <thead class="thead-light">
                  <tr>
                    <th>SR.No</th>
                    <th>Product Name</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Buy Date</th>
                  </tr>
                </thead>
                <tbody>
                  <% user['purchases'].forEach(purchase => { %>
                    <% purchase['cart'].forEach((product,index) => { %>
                      <tr>
                        <td><%= index+1 %> </td>
                        <td><%= product.item.title %>  </td>
                        <td><%= product.qty %>  </td>
                        <td><%= product.price %>  </td>
                        <td><%= purchase.createdAt.toDateString() %>  </td>
                      </tr>
                    <% }) %>
                  <% }) %>
                </tbody>
              </table>
          </div>
          <% }else{ %>
            <div class="col-12">
              <h3>You haven't buyed anything yet</h3>
            </div>
          <% } %> 

            
        </div>
    </div>
    <!--Purchase Table-->


    <%- include('partials/footer') %> 





    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script> -->

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
   
  </body>
</html>